<!DOCTYPE HTML>

<html>
   <head>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.bundle.js"></script>
      <script type = "text/javascript">
        window.onload = function() {
            if ("WebSocket" in window) {
              // Let us open a web socket
              var ws = new WebSocket("ws://localhost:7654");
              ws.onopen = function() {
                WebSocket_SendGetSetPoint()
              };                   // Web Socket is connected, send data using send()
              ws.onmessage = function(evt) {
                  var received_msg = evt.data;
                  var jsonobj = JSON.parse(received_msg)                  

                  var commandHandlerMap = {
                     "GetSetPoint": WebSocket_HandleGetSetPointAnswer,
                  };      

                  commandHandlerMap[jsonobj.Command](jsonobj)
              };

              ws.onclose = function() { 

              };
            } else {
              // The browser doesn't support WebSocket
              alert("WebSocket NOT supported by your Browser!");
            }            
        };

        function WebSocket_SendGetSetPoint(){
          ws.send("GetSetPoint");
        }

        function WebSocket_HandleGetSetPointAnswer(jsonobj) {
           var selectList = document.getElementById("DatabasesElement");
           selectList.onchange = function(){RetreiveDatabase};
           //Create and append select list
           //var selectList = document.createElement("select");
           //selectList.setAttribute("id", "mySelect");
           //myDiv.appendChild(selectList);

           //Create and append the options
           for (var i = 0; i < jsonobj.Databases.length; i++) {
               var option = document.createElement("option");
               option.setAttribute("value", jsonobj.Databases[i]);
               option.text = jsonobj.Databases[i];
               selectList.appendChild(option);
           }
        }
      </script>
   </head>
   <body>
      <form action="/action_page.php">
      Set Point: <input type="text" name="SetPoint" value="0.0">
      <input type="submit" value="Submit">
      </form>
      <div style="height: 300px">
         <canvas id="myChart"></canvas>
      </div>      
   </body>
</html>